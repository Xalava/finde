<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>Financial Defense</title>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <div id="app-container">
        <header id="topbar">
            <div class="logo">
                <span class="icon">üíº</span>
                <span class="title">Financial Defense</span>
            </div>
            <div class="stats">
                <div class="stat-item" data-tooltip="Current game day">
                    üóìÔ∏è <strong class="ui-name">Day</strong> <span id="day">0</span><span id="holiday"></span>
                </div>
            </div>

            <div>
                <button id="research-button" class="stat-item command-button hidden" data-tooltip="Technology Tree">
                    üß™ <strong class="ui-name">Research</strong> <span id="research-points">0</span>
                </button>
            </div>
            <div>
                <button id="policy-button" class="stat-item command-button hidden" data-tooltip="Policy">
                    üìú <strong class="ui-name">Policies <span id="policy-status">‚öñÔ∏è</span></strong>
                </button>
            </div>

            <div class="indicators">
                <div id="gdp-stat-item" class="stat-item" data-tooltip="GDP from financial transactions (past quarter)">
                    üìä <strong class="ui-name">GDP </strong><span id="gdp">0</span>
                </div>
                <div class="stat-item" data-tooltip="Available operational budget">
                    üí∞ <strong class="ui-name">Budget</strong> <span id="budget">150</span>
                </div>
                <div id="maintenance-stat-item" class="stat-item"
                    data-tooltip="Ongoing system maintenance costs per second">
                    üõ†Ô∏è <strong class="ui-name">Upkeep</strong> <span id="maintenance">0</span>
                </div>
                <!-- 
                <div class="stat-item pulse-animation" data-tooltip="Your public trust rating">
                    üåü <strong>Reputation:</strong> <span id="reputation">100</span>
                </div> -->
            </div>
        </header>

        <main id="game-container">
            <canvas id="game"></canvas>

            <div id="node-details-panel" class="panel hidden">
                <div class="panel-header">
                    <h2 id="panel-title">Node Name</h2>
                    <button id="close-panel" class="close-button">√ó</button>
                </div>
                <div class="panel-content">

                    <div class="reputation-container">
                        <h3 class="">Reputation</h3>
                        <div class="bar-container">
                            <div class="bar-fill good" id="reputation-bar" style="width: 80%"></div>
                        </div>
                        <div class="bar-value" id="reputation-value">80</div>
                    </div>
                    <details class="node-details">
                        <br>
                        <div class="detail-row">
                            <div class="detail-label">Type of institution</div>
                            <div class="detail-value" id="panel-type">Bank</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Corruption Level</div>
                            <div class="detail-value" id="panel-corruption">0</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Total Funds Processed</div>
                            <div>$</div>
                            <div class="detail-value" id="panel-received">0</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Illegal Funds Seized</div>
                            <div>$</div>
                            <div class="detail-value" id="panel-detected">0</div>
                        </div>
                    </details>

                    <div class="panel-section">
                        <h3>Control Systems</h3>
                        <div id="tower-options" class="options-section">
                            <!-- Tower buttons will be added dynamically -->
                        </div>
                        <br>
                        <h3>Enforcement</h3>
                        <div id="action-options" class="options-section">
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Tutorial Container -->
        <div id="tutorial" class="panel hidden">
            <div id="tutorial-header" class="panel-header">
                <h2 id="tutorial-title"></h2>
            </div>
            <div id="tutorial-content" class="panel-content"></div>
            <div id="tutorial-progress-container">
                <div id="tutorial-progress"></div>
            </div>
            <div id="tutorial-buttons" class="panel-footer"></div>
        </div>


        <div id="instructions" class="panel hidden">
            <div class="panel-header">
                <h3>üíº Financial Defense System</h3>
                <button class="close-button" id="close-instructions">√ó</button>
            </div>
            <div class="instruction-content">
                <p>Monitor and secure the financial network against illegal transactions and corruption.</p>

                <h3>Controls:</h3>
                <ul>
                    <li><strong>Click</strong> on any node to view details and install control systems</li>
                    <li>Use <strong>Basic Filters</strong> to begin detecting illegal transactions</li>
                    <li>Research <strong>AI Systems</strong> for better accuracy but maintenance costs</li>
                    <li>Trigger <strong>Audits</strong> to reduce existing corruption at an entity</li>
                </ul>

                <h3>Game Objectives:</h3>
                <ul>
                    <li>Prevent the spread of corruption throughout the network</li>
                    <li>Maintain a positive budget by collecting taxes from transactions</li>
                </ul>
                <h3>Game mechanics:</h3>
                <ul>
                    <li>Holidays result in more transactions</li>
                    <li>Entities with higher corruption produce more illegal transactions</li>
                </ul>
            </div>
        </div>
        <div id="research-panel" class="panel command-panel hidden">
            <div class="panel-header">
                <h2>Research</h2>
                <button id="close-research" class="close-button">√ó</button>
            </div>
            <div class="panel-tabs">
                <button class="tab-button active" data-tab="compliance">Compliance</button>
                <button class="tab-button" data-tab="enforcement">Enforcement</button>
                <button class="tab-button" data-tab="network">Network</button>
            </div>
            <div class="panel-content">
                <div id="tech-tree-container"></div>
            </div>
        </div>
        <div id="policy-panel" class="panel command-panel hidden">
            <div class="panel-header">
                <h2>Policy</h2><button id="close-policy">√ó</button>
            </div>
            <div class="panel-content">
                <div class="policy-row">
                    <label class="policy-option">
                        <span class="policy-icon">üåø</span>
                        <span><b>Lenient</b></span>
                        <span class="policy-hint">Fewer false positives, but less detection </span>
                        <input type="radio" name="reg" value="lenient">
                    </label>
                    <label class="policy-option">

                        <span class="policy-icon">‚öñÔ∏è</span>
                        <span><b>Balanced</b></span>
                        <span class="policy-hint">Default</span>
                        <input type="radio" name="reg" value="balanced" checked>
                    </label>
                    <label class="policy-option">
                        <span class="policy-icon">üîí</span>
                        <span><b>Stringent</b></span>
                        <span class="policy-hint">More detection, but also more false positives</span>
                        <input type="radio" name="reg" value="stringent">
                    </label>
                </div>
                <br>
                <h3>üó≥Ô∏è Ecosystem Sentiment </h3>
                <br>
                <div id="sentiment-wrap" data-tooltip="Updates regularly based on policy level and changes">
                    <div id="sentiment-bar"></div>
                </div>
                <div style="text-align: center;">
                    <i>Œî <span id="policy-points">0</span> per quarter</i>
                </div>
                <br><br>
                <div data-tooltip="Manual approval for new nodes; more control, slower expansion">
                    <label class="policy-checkbox">
                        <input type="checkbox" id="approvals-policy">
                        <span><b>Mandatory Approvals</b></span>
                        <span class="policy-hint">Gate new actors</span>
                    </label>
                </div>
                <br><br>
                <div id="approvals"></div>
            </div>
        </div>
    </div>

    <div id="toast-container">
        <!-- Notification toasts will be added here dynamically -->
    </div>

    <div class="game-controls">
        <button id="toggle-instructions">‚ùî <span class="ui-name">Explanations</span></button>
        <button id="center-view">‚≠ïÔ∏è <span class="ui-name">Center</span></button>
        <div id="debug-controls">
            <button id="toggle-debug">üîß <span class="ui-name">Debug</span></button>
        </div>
        <div>
            <button id="slow">‚èØÔ∏è </button>
            <button id="normal">‚ñ∂Ô∏è </button>
            <button id="fast">‚è©Ô∏è</button>
        </div>
    </div>

    <script src="main.js" type="module"></script>
</body>

</html>
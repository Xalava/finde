<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>Financial Defense</title>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <div id="app-container">
        <header id="topbar">
            <div class="logo">
                <span class="icon">üíº</span>
                <span class="title">Financial Defense</span>
            </div>
            <div class="stat-item" data-tooltip="Current game day">
                <span class="stat-icon">üóìÔ∏è</span>
                <strong class="ui-name">Day</strong>
                <span id="day">0</span><span id="holiday"></span>
            </div>
            <button id="research-button" class="stat-item command-button hidden" data-tooltip="Technology Tree">
                <span class="stat-icon">üß™</span>
                <strong class="ui-name">Research</strong>
                <span id="research-points">0</span>
            </button>
            <button id="policy-button" class="stat-item command-button hidden" data-tooltip="Policy decisions">
                <span class="stat-icon">üìú</span>
                <strong class="ui-name">Policies</strong>
                <span id="policy-status">‚öñÔ∏è</span>
            </button>
            <div id="separator"></div>
            <div id="gdp-stat-item" class="stat-item" data-tooltip="GDP from financial transactions (past quarter)">
                <span class="stat-icon">üìä</span>
                <strong class="ui-name">GDP</strong>
                <span id="gdp">0</span>
            </div>
            <div class="stat-item" data-tooltip="Available operational budget">
                <span class="stat-icon">üí∞</span>
                <strong class="ui-name">Budget</strong>
                <span id="budget">150</span>
            </div>
            <div id="maintenance-stat-item" class="stat-item" data-tooltip="Ongoing system maintenance costs per second">
                <span class="stat-icon">üõ†Ô∏è</span>
                <strong class="ui-name">Upkeep</strong>
                <span id="maintenance">0</span>
            </div>
            <!-- 
                <div class="stat-item pulse-animation" data-tooltip="Your public trust rating">
                    üåü <strong>Reputation:</strong> <span id="reputation">100</span>
                </div> -->

        </header>

        <main id="game-container">
            <canvas id="game"></canvas>

            <aside id="node-details-panel" class="panel hidden">
                <div class="panel-header">
                    <h2 id="panel-title">Node Name</h2>
                    <button id="close-panel" class="close-button">√ó</button>
                </div>
                <div class="panel-content">

                    <section class="panel-section">
                        <h3>Reputation</h3>
                        <div class="bar-container">
                            <div class="bar-fill good" id="reputation-bar" style="width: 80%"></div>
                        </div>
                        <div class="bar-value" id="reputation-value">80</div>
                    </section>

                    <details class="node-details">
                        <summary>Details</summary>
                        <div class="detail-row">
                            <span class="detail-label">Type of institution</span>
                            <span class="detail-value" id="panel-type">Bank</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Country</span>
                            <span id="country-name"></span>

                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Corruption Level</span>
                            <span class="detail-value" id="panel-corruption">0</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Total Funds Processed</span>
                            <span>$ <span class="detail-value" id="panel-received">0</span></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Illegal Funds Seized</span>
                            <span>$ <span class="detail-value" id="panel-detected">0</span></span>
                        </div>
                    </details>

                    <section class="panel-section">
                        <h3>Control Systems</h3>
                        <div id="tower-options" class="options-section"></div>
                        <br>
                        <h3>Enforcement</h3>
                        <div id="action-options" class="options-section"></div>
                    </section>
                </div>
            </aside>

            <aside id="user-details-panel" class="panel hidden">
                <div class="panel-header">
                    <h2 id="user-name">User</h2>

                    <button id="close-user-panel" class="close-button">√ó</button>
                </div>
                <div class="panel-content">
                    <div id="user-details">
                        A <span id="user-type"></span> in <span id="user-country"></span>

                    </div>
                    <div class="transaction-section">
                        <h3>Ongoing Transactions</h3>
                        <div id="user-transactions" class="transaction-list">
                            <div class="no-transactions">No pending sent transactions</div>
                        </div>
                    </div>
                </div>
            </aside>
        </main>

        <aside id="tutorial" class="panel hidden">
            <div id="tutorial-header" class="panel-header">
                <h2 id="tutorial-title"></h2>
            </div>
            <div id="tutorial-content" class="panel-content"></div>
            <div id="tutorial-buttons" class="panel-footer"></div>
            <div id="tutorial-progress-container">
                <div id="tutorial-progress"></div>
            </div>
        </aside>


        <aside id="instructions" class="panel hidden">
            <div class="panel-header">
                <h3>üíº Financial Defense</h3>
                <button class="close-button" id="close-instructions">√ó</button>
            </div>
            <div class="instruction-content">
                <p>Monitor and secure the financial network against illegal transactions and corruption.</p>

                <h3>Controls:</h3>
                <ul>
                    <li><strong>Click</strong> on any node to view details and act</li>
                    <li>Install <strong>filters</strong> to detect illegal transactions</li>
                    <li>Trigger <strong>audits</strong> to reduce existing corruption</li>
                    <li>Research <strong>AI Systems</strong> for better accuracy but maintenance costs</li>
                </ul>

                <h3>Game Objectives:</h3>
                <ul>
                    <li>Prevent the spread of corruption throughout the network</li>
                    <li>Allow the development of a thriving ecosystem</li>
                </ul>
                <h3>Game mechanics:</h3>
                <ul>
                    <li>Holidays result in more transactions</li>
                    <li>Entities with higher corruption produce more illegal transactions</li>
                </ul>
            </div>
        </aside>
        </aside>
        <aside id="research-panel" class="panel command-panel hidden">
            <div class="panel-header">
                <h2>Research</h2>
                <button id="close-research" class="close-button">√ó</button>
            </div>
            <div class="panel-tabs">
                <button class="tab-button active" data-tab="compliance">Compliance</button>
                <button class="tab-button" data-tab="enforcement">Enforcement</button>
                <button class="tab-button" data-tab="network">Network</button>
            </div>
            <div class="panel-content">
                <div id="tech-tree-container"></div>
            </div>
        </aside>
        <aside id="policy-panel" class="panel command-panel hidden">
            <div class="panel-header">
                <h2>Policy</h2>
                <button id="close-policy" class="close-button">√ó</button>
            </div>
            <div class="panel-content">
                <section class="panel-section">
                    <h3>üó≥Ô∏è Your Ecosystem Popularity</h3>
                    <div id="popularity-wrap" data-tooltip="Updates regularly based on policy level and changes">
                        <div id="popularity-bar"></div>
                    </div>
                    <div style="text-align: center;">
                        <em>Œî <span id="policy-points">0</span> per quarter</em>
                    </div>
                </section>
                <br>
                <section class="panel-section policy-row" data-tooltip="Set the compliance level.">
                    <label class="policy-option">
                        <span class="policy-icon">üåø</span>
                        <strong>Lenient</strong>
                        <span class="policy-hint">Fewer false positives, but less detection</span>
                        <input type="radio" name="reg" value="lenient">
                    </label>
                    <label class="policy-option">
                        <span class="policy-icon">‚öñÔ∏è</span>
                        <strong>Balanced</strong>
                        <span class="policy-hint">Default policy. No impact on popularity</span>
                        <input type="radio" name="reg" value="balanced" checked>
                    </label>
                    <label class="policy-option">
                        <span class="policy-icon">üîí</span>
                        <strong>Stringent</strong>
                        <span class="policy-hint">More detection, but more false positives</span>
                        <input type="radio" name="reg" value="stringent">
                    </label>
                </section>
                <section class="panel-section" data-tooltip="Set the national taxation level.">
                    <h3>üí∞Ô∏è Taxation Level</h3>
                    <div class="tax-slider-wrapper">
                        <label for="taxation-slider">Rate: <span id="taxation-value">20</span>%</label>
                        <input type="range" id="taxation-slider" name="taxation" min="0" max="50" value="20" class="policy-slider">
                    </div>
                </section>
                <section class="panel-section" data-tooltip="Require minimum filter compliance for banks. Non-compliant banks trigger automated tower placement.">
                    <h3>üè¶ Minmal Compliance</h3>
                    <p class="policy-hint">Banks will be required to install compliant
                        filters automatically. Have the appropriate budget ready.</p>
                    <br>
                    <select id="compliance-select" class="compliance-select">
                        <option value="0">None - No requirements</option>
                        <option value="1">Basic filter required</option>
                        <option value="2">Medium filter required</option>
                        <!-- <option value="3">High level filter required</option> -->
                    </select>
                </section>
                <section class="panel-section" data-tooltip="Manual approval for new nodes; more control, slower expansion">
                    <label class="policy-checkbox">
                        <input type="checkbox" id="approvals-policy">
                        <strong>Mandatory Approvals</strong>
                        <span class="policy-hint">Gate new actors</span>
                    </label>
                </section>

                <section class="panel-section" id="approvals"></section>
            </div>
        </aside>

        <aside id="gdp-panel" class="panel command-panel hidden">
            <div class="panel-header">
                <h2>Analytics</h2>
                <button id="close-gdp" class="close-button">√ó</button>
            </div>
            <div class="panel-tabs">
                <button id="chart-tab" class="tab-button active" data-tab="chart">Chart</button>
                <button id="transactions-tab" class="tab-button" data-tab="transactions">Transactions</button>
            </div>
            <div class="panel-content">
                <section class="panel-section" id="chart-section">
                    <h3>Transaction Flow Over Time</h3>
                    <div id="gdp-chart-container">
                        <canvas id="gdp-chart"></canvas>
                    </div>
                    <div class="gdp-controls">
                        <button id="volume-btn" class="active" data-view="volume">Volume ($)</button>
                        <button id="count-btn" data-view="count">Count (#)</button>
                    </div>
                </section>
                <section class="panel-section hidden" id="transactions-section">
                    <h3>All Transactions</h3>
                    <div id="all-transactions" class="transaction-list">
                        <div class="no-transactions">No transactions found</div>
                    </div>
                </section>
            </div>
        </aside>
    </div>

    <div id="toast-container">
        <!-- Notification toasts will be added here dynamically -->
    </div>

    <div class="game-controls" id="game-controls">
        <div class="left-controls">
            <button id="toggle-instructions">‚ùî <span class="ui-name">Explanations</span></button>
        </div>
        <button id="center-view">‚≠ïÔ∏è <span class="ui-name">Center</span></button>
        <div id="debug-controls">
            <button id="toggle-debug">üîß <span class="ui-name">Debug</span></button>
        </div>
        <button id="restart-game" class="hidden">üîÑ <span class="ui-name">Restart</span></button>
        <button id="toggle-countries">üá∫üá≥ <span class="ui-name">Countries</span></button>
        <div>
            <button id="slow">‚èØÔ∏è</button>
            <button id="normal">‚ñ∂Ô∏è</button>
            <button id="fast">‚è©Ô∏è</button>
        </div>
    </div>

    <script src="main.js" type="module"></script>
</body>

</html>